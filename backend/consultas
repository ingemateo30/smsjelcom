DELETE FROM citas
WHERE (FECHA_CITA, NUMERO_IDE) IN (
    SELECT FECHA_CITA, NUMERO_IDE
    FROM citas
    GROUP BY FECHA_CITA, NUMERO_IDE
    HAVING COUNT(*) > 1
);



WITH duplicados AS (
    SELECT *,
           ROW_NUMBER() OVER (
               PARTITION BY FECHA_CITA, NUMERO_IDE 
               ORDER BY FECHA_CITA 
           ) AS fila_num
    FROM citas
)
SELECT *
FROM duplicados
WHERE fila_num > 1;